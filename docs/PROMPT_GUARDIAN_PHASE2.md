# üõ°Ô∏è PROMPT - GUARDIAN PHASE 2 : Documentation & CI/CD

**Date de cr√©ation :** 2025-10-21
**Contexte :** Suite imm√©diate Phase 1 (Quick Wins termin√©e)
**Dur√©e estim√©e Phase 2 :** 5-7h
**Agent recommand√© :** Claude Code

---

## üìã CONTEXTE : CE QUI A √âT√â FAIT (Phase 1)

### ‚úÖ Phase 1 compl√©t√©e (2025-10-21 09:30 CET)

**Commits :**
- `1583a92` - refactor(guardian): Phase 1 - Unification structure rapports (Quick Wins)
- `1ff832f` - fix(guardian): auto_update_docs.py use unified reports/ path

**Actions r√©alis√©es :**

1. **Unification rapports** ‚Üí 1 seul emplacement
   - Modifi√© 6 scripts Guardian pour √©crire dans `reports/` (racine)
   - Supprim√© `claude-plugins/integrity-docs-guardian/reports/`
   - Plus de duplication (√©tait 13 fichiers √ó 2)

2. **Nettoyage rapports**
   - Cr√©√© `reports/archive/`
   - Archiv√© 9 rapports obsol√®tes
   - Structure propre : 7 rapports actifs + archive

3. **Unification Task Scheduler**
   - Supprim√© 3 t√¢ches redondantes
   - Gard√© uniquement : `EMERGENCE_Guardian_ProdMonitor`

4. **Documentation mise √† jour**
   - `README_GUARDIAN.md` : emplacements + Task Scheduler
   - Audit complet : `docs/GUARDIAN_AUDIT_RECOMMENDATIONS.md` (626 lignes)

5. **Tests complets**
   - ‚úÖ Tous agents Guardian fonctionnels
   - ‚úÖ Hooks Git (pre-commit, post-commit, pre-push) OK

**R√©sultat actuel :**
- 1 seul emplacement : `reports/` (racine)
- 0 duplication, 0 confusion
- Structure propre et test√©e

---

## üéØ TON OBJECTIF : PHASE 2

Impl√©menter la **Phase 2** du plan d'optimisation Guardian :
1. **Consolidation documentation** (1 guide unique)
2. **GitHub Actions CI/CD** (tests + d√©ploiement automatis√©s)

**R√©f√©rence compl√®te :** [docs/GUARDIAN_AUDIT_RECOMMENDATIONS.md](docs/GUARDIAN_AUDIT_RECOMMENDATIONS.md)
- Sections "Priorit√© 4" et "Priorit√© 5"

---

## üìö PHASE 2.1 : CONSOLIDATION DOCUMENTATION

### Objectif

Cr√©er **1 seul guide complet** au lieu de 10+ docs fragment√©es.

### Probl√®me actuel

**Documentation Guardian fragment√©e :**
- `README_GUARDIAN.md`
- `PRODGUARDIAN_README.md`
- `PRODGUARDIAN_SETUP.md`
- `PROD_MONITORING_ACTIVATED.md`
- `PROD_AUTO_MONITOR_SETUP.md`
- `GUARDIAN_CLOUD_IMPLEMENTATION_PLAN.md`
- `GUARDIAN_CLOUD_MIGRATION.md`
- `GUARDIAN_AUTOMATION.md`
- etc.

**Impact :**
- Difficile de savoir par o√π commencer
- Information fragment√©e
- Redondances dans les explications

### Actions √† faire

#### 1. Cr√©er `docs/GUARDIAN_COMPLETE_GUIDE.md`

**Structure recommand√©e :**

```markdown
# üõ°Ô∏è GUARDIAN - GUIDE COMPLET

## Table des mati√®res
1. Vue d'ensemble
2. Agents Guardian (descriptions d√©taill√©es)
3. Installation & Activation
4. Workflows automatiques
5. Rapports (emplacements, formats, acc√®s)
6. Commandes utiles
7. Troubleshooting
8. Plans Cloud (futur)
9. FAQ

## 1. Vue d'ensemble
[Tableau des 6 agents : Anima, Neo, Nexus, ProdGuardian, Argus, Theia]
[Architecture globale]

## 2. Agents Guardian

### 2.1 ANIMA (DocKeeper)
- R√¥le : Documentation gaps, versioning
- Trigger : Pre-commit, Manuel
- Rapport : docs_report.json
- Configuration : ...
- D√©tails techniques : ...

### 2.2 NEO (IntegrityWatcher)
[...]

### 2.3 NEXUS (Coordinator)
[...]

### 2.4 PRODGUARDIAN
[...]

### 2.5 ARGUS (DevLogs Analyzer)
[...]

### 2.6 THEIA (Cost Analyzer)
[...]

## 3. Installation & Activation

### 3.1 Installation rapide
```powershell
cd claude-plugins/integrity-docs-guardian/scripts
.\setup_guardian.ps1
```

### 3.2 Configuration avanc√©e
[Options : --IntervalHours, --EmailTo, etc.]

### 3.3 V√©rification installation
[Commandes de test]

## 4. Workflows automatiques

### 4.1 Pre-Commit Hook (BLOQUANT)
[D√©tails : Anima + Neo, quand √ßa bloque, comment bypass]

### 4.2 Post-Commit Hook (Non-bloquant)
[D√©tails : Nexus + Codex Summary + Auto-update docs]

### 4.3 Pre-Push Hook (BLOQUANT Production)
[D√©tails : ProdGuardian, quand √ßa bloque]

### 4.4 Task Scheduler (Background)
[T√¢che : EMERGENCE_Guardian_ProdMonitor]
[Fr√©quence : 6h]
[Modifier fr√©quence : ...]

## 5. Rapports

### 5.1 Emplacements (IMPORTANT !)

**Tous les rapports sont dans `reports/` (racine) :**

| Fichier | Agent | Contenu |
|---------|-------|---------|
| prod_report.json | PRODGUARDIAN | √âtat production |
| docs_report.json | ANIMA | Documentation gaps |
| integrity_report.json | NEO | Int√©grit√© backend/frontend |
| unified_report.json | NEXUS | Vue unifi√©e |
| global_report.json | Master Orchestrator | Rapport global |
| codex_summary.md | Auto | R√©sum√© pour Codex GPT |

**Rapports archiv√©s :** `reports/archive/`

### 5.2 Formats des rapports
[Structure JSON de chaque type de rapport]

### 5.3 Acc√®s rapports (pour agents IA)
```python
# Recommand√© : R√©sum√© markdown
with open('reports/codex_summary.md', 'r', encoding='utf-8') as f:
    print(f.read())

# D√©tails : JSON bruts
import json
with open('reports/prod_report.json', 'r', encoding='utf-8') as f:
    prod = json.load(f)
```

## 6. Commandes utiles

### 6.1 Audit manuel global
```powershell
.\run_audit.ps1
```

### 6.2 Tests individuels agents
```bash
python claude-plugins/.../scripts/scan_docs.py
python claude-plugins/.../scripts/check_integrity.py
...
```

### 6.3 R√©g√©n√©rer Codex Summary
```bash
python scripts/generate_codex_summary.py
```

## 7. Troubleshooting

### 7.1 Hooks Git ne se d√©clenchent pas
[Solutions]

### 7.2 Rapports pas g√©n√©r√©s
[Solutions]

### 7.3 Task Scheduler ne s'ex√©cute pas
[Solutions]

### 7.4 ProdGuardian timeout
[Solutions]

## 8. Plans Cloud (futur)

**Documents de r√©f√©rence :**
- [GUARDIAN_CLOUD_IMPLEMENTATION_PLAN.md](GUARDIAN_CLOUD_IMPLEMENTATION_PLAN.md) (v2.0.0)
- [GUARDIAN_CLOUD_MIGRATION.md](GUARDIAN_CLOUD_MIGRATION.md) (v1.0.0)

**Fonctionnalit√©s pr√©vues :**
- Service Cloud Run `emergence-guardian-service`
- Monitoring 24/7 (toutes les 2h)
- Cloud Storage pour rapports
- Gmail API pour Codex
- Usage Tracking
- Trigger manuel depuis Admin UI

**Status :** üìã PLANIFICATION (pas encore impl√©ment√©)

## 9. FAQ

### Pourquoi il y a plusieurs emplacements de rapports ?
[R√©ponse : c'√©tait le cas avant, maintenant unifi√© dans reports/]

### Comment Codex GPT acc√®de aux rapports ?
[R√©ponse : lit reports/codex_summary.md localement]

### Puis-je d√©sactiver Guardian ?
[R√©ponse : oui, setup_guardian.ps1 -Disable]

### Quelle est la diff√©rence entre les agents ?
[Tableau comparatif]
```

#### 2. Consolider les informations

**Sources √† fusionner dans le guide complet :**
1. `claude-plugins/integrity-docs-guardian/README_GUARDIAN.md` ‚úÖ (base principale)
2. `claude-plugins/integrity-docs-guardian/PRODGUARDIAN_README.md`
3. `claude-plugins/integrity-docs-guardian/PRODGUARDIAN_SETUP.md`
4. `claude-plugins/integrity-docs-guardian/PROD_MONITORING_ACTIVATED.md`
5. `claude-plugins/integrity-docs-guardian/PROD_AUTO_MONITOR_SETUP.md`
6. `claude-plugins/integrity-docs-guardian/GUARDIAN_AUTOMATION.md`
7. `docs/GUARDIAN_CLOUD_IMPLEMENTATION_PLAN.md` (r√©f√©rence seulement)
8. `docs/GUARDIAN_CLOUD_MIGRATION.md` (r√©f√©rence seulement)
9. `PROMPT_CODEX_RAPPORTS.md` (section acc√®s rapports)

**M√©thode :**
- Lire chaque fichier source
- Extraire les sections uniques (pas de duplication)
- Organiser dans la structure du guide complet
- Ajouter r√©f√©rences crois√©es vers plans cloud

#### 3. Archiver les docs fragment√©es

```bash
mkdir -p claude-plugins/integrity-docs-guardian/docs/archive

# D√©placer les docs fragment√©es
mv claude-plugins/integrity-docs-guardian/PRODGUARDIAN_*.md \
   claude-plugins/integrity-docs-guardian/docs/archive/

mv claude-plugins/integrity-docs-guardian/PROD_*.md \
   claude-plugins/integrity-docs-guardian/docs/archive/

mv claude-plugins/integrity-docs-guardian/GUARDIAN_AUTOMATION.md \
   claude-plugins/integrity-docs-guardian/docs/archive/
```

**Cr√©er `claude-plugins/integrity-docs-guardian/docs/archive/README.md` :**
```markdown
# Docs Guardian archiv√©es

Ces documents ont √©t√© consolid√©s dans **docs/GUARDIAN_COMPLETE_GUIDE.md**.

Conserv√©s ici pour r√©f√©rence historique.

Liste :
- PRODGUARDIAN_README.md
- PRODGUARDIAN_SETUP.md
- PROD_MONITORING_ACTIVATED.md
- PROD_AUTO_MONITOR_SETUP.md
- GUARDIAN_AUTOMATION.md
```

#### 4. Mettre √† jour les liens

**Fichiers √† modifier :**
1. `CLAUDE.md` ‚Üí pointer vers `docs/GUARDIAN_COMPLETE_GUIDE.md`
2. `CODEX_GPT_SYSTEM_PROMPT.md` ‚Üí pointer vers guide complet
3. `PROMPT_CODEX_RAPPORTS.md` ‚Üí r√©f√©rence au guide complet
4. `README_GUARDIAN.md` ‚Üí devenir alias/lien vers guide complet

**Exemple modification `CLAUDE.md` :**
```markdown
## ü§ñ SYST√àME GUARDIAN (AUTOMATIQUE)

**Documentation compl√®te :** [docs/GUARDIAN_COMPLETE_GUIDE.md](docs/GUARDIAN_COMPLETE_GUIDE.md)

**Version 3.1.0 - Unifi√© et optimis√© (2025-10-21)**
```

### Livrables Phase 2.1

- [ ] `docs/GUARDIAN_COMPLETE_GUIDE.md` cr√©√© (~500-800 lignes)
- [ ] Docs fragment√©es archiv√©es dans `docs/archive/`
- [ ] Liens mis √† jour (CLAUDE.md, CODEX_GPT_SYSTEM_PROMPT.md, etc.)
- [ ] `README_GUARDIAN.md` converti en alias

**Temps estim√© :** 2-3h

---

## üîß PHASE 2.2 : GITHUB ACTIONS CI/CD

### Objectif

Automatiser tests, validation Guardian, et d√©ploiement Cloud Run.

### Probl√®me actuel

**1 seul workflow GitHub Actions :**
- `.github/workflows/bootstrap-smoke.yml` (24 lignes, basique)

**Manquants :**
- Tests automatiques sur PR
- Validation Guardian sur push
- D√©ploiement automatique Cloud Run
- Rapports Guardian dans artifacts

### Actions √† faire

#### 1. Cr√©er `.github/workflows/tests.yml`

**Tests & Guardian Validation**

```yaml
name: Tests & Guardian Validation

on:
  push:
    branches: ['**']
  pull_request:
    branches: [main]

jobs:
  # Job 1 : Tests Backend
  test-backend:
    name: Backend Tests (Python 3.11)
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-python@v4
        with:
          python-version: '3.11'
          cache: 'pip'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Run pytest
        run: pytest tests/backend/ -v --tb=short

      - name: Ruff check
        run: ruff check src/backend/

      - name: Mypy type checking
        run: mypy src/backend/ --ignore-missing-imports

  # Job 2 : Tests Frontend
  test-frontend:
    name: Frontend Tests (Node 18)
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Build frontend
        run: npm run build

  # Job 3 : Guardian Validation
  guardian:
    name: Guardian Validation
    runs-on: ubuntu-latest
    needs: [test-backend, test-frontend]

    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-python@v4
        with:
          python-version: '3.11'
          cache: 'pip'

      - name: Install dependencies
        run: pip install -r requirements.txt

      - name: Run Anima (DocKeeper)
        run: python claude-plugins/integrity-docs-guardian/scripts/scan_docs.py

      - name: Run Neo (IntegrityWatcher)
        run: python claude-plugins/integrity-docs-guardian/scripts/check_integrity.py

      - name: Run Nexus (Coordinator)
        run: python claude-plugins/integrity-docs-guardian/scripts/generate_report.py

      - name: Generate Codex Summary
        run: python scripts/generate_codex_summary.py

      - name: Upload Guardian Reports
        uses: actions/upload-artifact@v3
        if: always()
        with:
          name: guardian-reports
          path: |
            reports/*.json
            reports/codex_summary.md
          retention-days: 30

      - name: Check for Guardian failures
        run: |
          if grep -q '"status": "error"' reports/*.json; then
            echo "‚ùå Guardian d√©tect√© des erreurs"
            exit 1
          fi
          echo "‚úÖ Guardian validation OK"
```

#### 2. Cr√©er `.github/workflows/deploy.yml`

**D√©ploiement automatique Cloud Run**

```yaml
name: Deploy to Cloud Run

on:
  push:
    branches: [main]

env:
  GCP_PROJECT_ID: emergence-469005
  GCP_REGION: europe-west1
  SERVICE_NAME: emergence-app
  IMAGE_NAME: gcr.io/emergence-469005/emergence-app

jobs:
  deploy:
    name: Build & Deploy to Cloud Run
    runs-on: ubuntu-latest

    # Only run if tests pass
    needs: []  # Optionnel : ajouter dependency sur workflow tests

    steps:
      - uses: actions/checkout@v4

      # Setup gcloud CLI
      - uses: google-github-actions/setup-gcloud@v1
        with:
          service_account_key: ${{ secrets.GCP_SA_KEY }}
          project_id: ${{ env.GCP_PROJECT_ID }}
          export_default_credentials: true

      # Configure Docker to use gcloud as credential helper
      - name: Configure Docker
        run: gcloud auth configure-docker

      # Build Docker image
      - name: Build Docker image
        run: |
          docker build -t ${{ env.IMAGE_NAME }}:${{ github.sha }} .
          docker tag ${{ env.IMAGE_NAME }}:${{ github.sha }} ${{ env.IMAGE_NAME }}:latest

      # Push to Google Container Registry
      - name: Push to GCR
        run: |
          docker push ${{ env.IMAGE_NAME }}:${{ github.sha }}
          docker push ${{ env.IMAGE_NAME }}:latest

      # Deploy to Cloud Run
      - name: Deploy to Cloud Run
        run: |
          gcloud run deploy ${{ env.SERVICE_NAME }} \
            --image ${{ env.IMAGE_NAME }}:${{ github.sha }} \
            --region ${{ env.GCP_REGION }} \
            --platform managed \
            --allow-unauthenticated \
            --memory 2Gi \
            --cpu 2 \
            --min-instances 0 \
            --max-instances 10 \
            --timeout 300s \
            --quiet

      # Get service URL
      - name: Get Service URL
        id: service-url
        run: |
          SERVICE_URL=$(gcloud run services describe ${{ env.SERVICE_NAME }} \
            --region ${{ env.GCP_REGION }} \
            --format 'value(status.url)')
          echo "url=$SERVICE_URL" >> $GITHUB_OUTPUT
          echo "‚úÖ Deployed to: $SERVICE_URL"

      # Health check
      - name: Health Check
        run: |
          sleep 10  # Wait for service to be ready
          curl -f ${{ steps.service-url.outputs.url }}/health || exit 1
          echo "‚úÖ Health check passed"
```

#### 3. Configurer secrets GitHub

**Secrets n√©cessaires :**

1. `GCP_SA_KEY` - Service Account Key pour d√©ploiement

   **Comment l'obtenir :**
   ```bash
   # Cr√©er service account
   gcloud iam service-accounts create github-actions \
     --display-name "GitHub Actions"

   # Donner permissions
   gcloud projects add-iam-policy-binding emergence-469005 \
     --member "serviceAccount:github-actions@emergence-469005.iam.gserviceaccount.com" \
     --role "roles/run.admin"

   gcloud projects add-iam-policy-binding emergence-469005 \
     --member "serviceAccount:github-actions@emergence-469005.iam.gserviceaccount.com" \
     --role "roles/storage.admin"

   # Cr√©er cl√© JSON
   gcloud iam service-accounts keys create key.json \
     --iam-account github-actions@emergence-469005.iam.gserviceaccount.com

   # Copier contenu de key.json dans GitHub secret GCP_SA_KEY
   cat key.json
   ```

2. Ajouter dans GitHub : Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí New repository secret
   - Name: `GCP_SA_KEY`
   - Secret: [contenu de key.json]

#### 4. Tester les workflows

**Test local avec act (optionnel) :**
```bash
# Installer act
brew install act  # macOS
# ou
choco install act  # Windows

# Tester workflow tests
act pull_request -W .github/workflows/tests.yml

# Tester workflow deploy (dry-run)
act push -W .github/workflows/deploy.yml --secret-file .secrets
```

**Test sur GitHub :**
1. Push sur une branche feature
2. Cr√©er PR vers main
3. V√©rifier que `tests.yml` s'ex√©cute
4. Merger PR
5. V√©rifier que `deploy.yml` s'ex√©cute et d√©ploie

### Livrables Phase 2.2

- [ ] `.github/workflows/tests.yml` cr√©√©
- [ ] `.github/workflows/deploy.yml` cr√©√©
- [ ] Secret `GCP_SA_KEY` configur√© dans GitHub
- [ ] Tests workflow sur PR
- [ ] D√©ploiement automatique test√©

**Temps estim√© :** 3-4h

---

## üìù CHECKLIST COMPL√àTE PHASE 2

### Phase 2.1 : Documentation

- [ ] Cr√©er `docs/GUARDIAN_COMPLETE_GUIDE.md`
  - [ ] Structure compl√®te (9 sections)
  - [ ] Consolidation de 8+ docs fragment√©es
  - [ ] R√©f√©rences aux plans cloud
  - [ ] FAQ compl√®te
- [ ] Archiver docs fragment√©es
  - [ ] Cr√©er `claude-plugins/.../docs/archive/`
  - [ ] D√©placer 5+ fichiers
  - [ ] README.md dans archive
- [ ] Mettre √† jour liens
  - [ ] CLAUDE.md
  - [ ] CODEX_GPT_SYSTEM_PROMPT.md
  - [ ] PROMPT_CODEX_RAPPORTS.md
  - [ ] README_GUARDIAN.md

### Phase 2.2 : CI/CD

- [ ] Cr√©er `.github/workflows/tests.yml`
  - [ ] Job test-backend (pytest, ruff, mypy)
  - [ ] Job test-frontend (npm build)
  - [ ] Job guardian (4 agents + upload artifacts)
- [ ] Cr√©er `.github/workflows/deploy.yml`
  - [ ] Build Docker image
  - [ ] Push to GCR
  - [ ] Deploy Cloud Run
  - [ ] Health check
- [ ] Configuration GitHub
  - [ ] Service Account GCP cr√©√©
  - [ ] Secret GCP_SA_KEY ajout√©
  - [ ] Permissions IAM configur√©es
- [ ] Tests
  - [ ] Workflow tests sur PR
  - [ ] Workflow deploy sur push main
  - [ ] D√©ploiement production v√©rifi√©

### Validation finale

- [ ] Documentation accessible et claire
- [ ] Workflows GitHub Actions fonctionnels
- [ ] D√©ploiement automatique OK
- [ ] Rapports Guardian dans artifacts
- [ ] Commit + push Phase 2
- [ ] Mise √† jour AGENT_SYNC.md

---

## üéØ COMMANDES RAPIDES

### Tester la documentation

```bash
# V√©rifier tous les liens markdown
grep -r "\[.*\](.*.md)" docs/GUARDIAN_COMPLETE_GUIDE.md

# V√©rifier structure
head -50 docs/GUARDIAN_COMPLETE_GUIDE.md
```

### Tester les workflows

```bash
# Valider syntaxe YAML
yamllint .github/workflows/*.yml

# Test local (si act install√©)
act pull_request -W .github/workflows/tests.yml --list
```

### Commit Phase 2

```bash
git add -A
git commit -m "feat(guardian): Phase 2 - Documentation consolid√©e + CI/CD GitHub Actions

Phase 2.1 - Documentation consolid√©e :
- Cr√©√© docs/GUARDIAN_COMPLETE_GUIDE.md (guide unique complet)
- Archiv√© 5+ docs fragment√©es
- Mis √† jour tous liens (CLAUDE.md, CODEX_GPT_SYSTEM_PROMPT.md, etc.)
- Structure claire : 9 sections, FAQ, r√©f√©rences cloud

Phase 2.2 - CI/CD GitHub Actions :
- Workflow tests.yml : pytest + ruff + mypy + Guardian validation
- Workflow deploy.yml : build Docker + push GCR + deploy Cloud Run
- Rapports Guardian dans artifacts (r√©tention 30j)
- D√©ploiement automatique sur push main

R√©sultat :
- 1 seul guide au lieu de 10+ docs
- Tests automatiques sur chaque PR
- D√©ploiement automatis√© Cloud Run
- Validation Guardian int√©gr√©e CI/CD

Temps Phase 2 : ~5-7h

ü§ñ Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"

git push
```

---

## üìö R√âF√âRENCES

### Documents essentiels √† lire

1. **Audit complet (Phase 1) :**
   - [docs/GUARDIAN_AUDIT_RECOMMENDATIONS.md](docs/GUARDIAN_AUDIT_RECOMMENDATIONS.md)
   - Sections Priorit√© 4-5

2. **√âtat actuel Guardian :**
   - [claude-plugins/integrity-docs-guardian/README_GUARDIAN.md](claude-plugins/integrity-docs-guardian/README_GUARDIAN.md)
   - Emplacements rapports, workflows, agents

3. **Docs fragment√©es √† consolider :**
   - `claude-plugins/integrity-docs-guardian/PRODGUARDIAN_*.md`
   - `claude-plugins/integrity-docs-guardian/PROD_*.md`
   - `claude-plugins/integrity-docs-guardian/GUARDIAN_AUTOMATION.md`

4. **Plans cloud (r√©f√©rence future) :**
   - [docs/GUARDIAN_CLOUD_IMPLEMENTATION_PLAN.md](docs/GUARDIAN_CLOUD_IMPLEMENTATION_PLAN.md)
   - [docs/GUARDIAN_CLOUD_MIGRATION.md](docs/GUARDIAN_CLOUD_MIGRATION.md)

### Structure actuelle projet

```
emergenceV8/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ bootstrap-smoke.yml  ‚Üê √Ä compl√©ter avec tests.yml + deploy.yml
‚îú‚îÄ‚îÄ claude-plugins/
‚îÇ   ‚îî‚îÄ‚îÄ integrity-docs-guardian/
‚îÇ       ‚îú‚îÄ‚îÄ README_GUARDIAN.md   ‚Üê Base pour guide complet
‚îÇ       ‚îú‚îÄ‚îÄ scripts/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ scan_docs.py     (Anima)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ check_integrity.py (Neo)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ generate_report.py (Nexus)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ check_prod_logs.py (ProdGuardian)
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ master_orchestrator.py
‚îÇ       ‚îî‚îÄ‚îÄ [docs fragment√©es √† consolider]
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ GUARDIAN_AUDIT_RECOMMENDATIONS.md  ‚Üê Audit complet
‚îÇ   ‚îú‚îÄ‚îÄ GUARDIAN_COMPLETE_GUIDE.md  ‚Üê √Ä CR√âER (Phase 2.1)
‚îÇ   ‚îú‚îÄ‚îÄ GUARDIAN_CLOUD_*.md  ‚Üê Plans futur
‚îÇ   ‚îî‚îÄ‚îÄ passation.md
‚îú‚îÄ‚îÄ reports/                     ‚Üê UNIFI√â (Phase 1 ‚úÖ)
‚îÇ   ‚îú‚îÄ‚îÄ prod_report.json
‚îÇ   ‚îú‚îÄ‚îÄ docs_report.json
‚îÇ   ‚îú‚îÄ‚îÄ integrity_report.json
‚îÇ   ‚îú‚îÄ‚îÄ unified_report.json
‚îÇ   ‚îú‚îÄ‚îÄ global_report.json
‚îÇ   ‚îú‚îÄ‚îÄ codex_summary.md
‚îÇ   ‚îî‚îÄ‚îÄ archive/
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ generate_codex_summary.py
‚îÇ   ‚îî‚îÄ‚îÄ analyze_guardian_structure.py
‚îú‚îÄ‚îÄ CLAUDE.md                    ‚Üê Liens √† mettre √† jour
‚îú‚îÄ‚îÄ CODEX_GPT_SYSTEM_PROMPT.md   ‚Üê Liens √† mettre √† jour
‚îî‚îÄ‚îÄ PROMPT_CODEX_RAPPORTS.md     ‚Üê Liens √† mettre √† jour
```

---

## ‚öôÔ∏è CONFIGURATION GCP (pour deploy.yml)

### Projet GCP actuel

- **Project ID :** `emergence-469005`
- **R√©gion :** `europe-west1`
- **Service Cloud Run :** `emergence-app`
- **Container Registry :** `gcr.io/emergence-469005`

### Ressources Cloud Run actuelles

```bash
# V√©rifier service actuel
gcloud run services describe emergence-app --region europe-west1

# Config actuelle (ref)
Memory: 2Gi
CPU: 2
Min instances: 0
Max instances: 10
Timeout: 300s
```

---

## üí° CONSEILS POUR L'IMPL√âMENTATION

### Documentation (Phase 2.1)

1. **Commence par la structure** : Cr√©e le squelette du guide complet d'abord
2. **Consolide section par section** : Ne fais pas tout d'un coup
3. **V√©rifie les liens** : Teste que tous les liens internes fonctionnent
4. **Garde concis** : √âlimine les redondances entre docs sources

### CI/CD (Phase 2.2)

1. **Teste localement d'abord** : Valide la syntaxe YAML
2. **Service Account** : Assure-toi que les permissions IAM sont OK
3. **Secrets** : V√©rifie que GCP_SA_KEY est bien configur√©
4. **Teste sur branche** : Ne push pas direct sur main
5. **Health check** : Assure-toi que l'endpoint /health existe

### Si tu bloques

**Probl√®me : Workflow GitHub Actions ne se d√©clenche pas**
- V√©rifie que le fichier est dans `.github/workflows/`
- V√©rifie syntaxe YAML (yamllint)
- V√©rifie permissions repo (Settings ‚Üí Actions)

**Probl√®me : D√©ploiement Cloud Run √©choue**
- V√©rifie Service Account permissions
- V√©rifie que le projet GCP est le bon
- V√©rifie que l'image Docker build correctement

**Probl√®me : Guardian agents √©chouent dans CI**
- Assure-toi que requirements.txt est install√©
- V√©rifie que chemins vers scripts sont corrects
- Regarde les logs dans artifacts

---

## ‚úÖ R√âSULTAT ATTENDU PHASE 2

**Apr√®s Phase 2, tu auras :**

### Documentation
- ‚úÖ 1 seul guide complet au lieu de 10+ docs
- ‚úÖ Structure claire : 9 sections, FAQ, troubleshooting
- ‚úÖ Docs fragment√©es archiv√©es
- ‚úÖ Liens mis √† jour partout
- ‚úÖ Facile √† maintenir

### CI/CD
- ‚úÖ Tests automatiques sur chaque PR
- ‚úÖ Validation Guardian int√©gr√©e
- ‚úÖ D√©ploiement automatique Cloud Run sur push main
- ‚úÖ Rapports Guardian dans artifacts GitHub
- ‚úÖ Health check post-d√©ploiement

### Impact
- ‚úÖ Processus de dev robuste
- ‚úÖ Moins d'erreurs en production
- ‚úÖ D√©ploiements plus rapides (automatis√©s)
- ‚úÖ Documentation centralis√©e et accessible

**Temps total Phase 2 : 5-7h**

**Prochaine √©tape : Phase 3 (Cloud Integration)** - Si besoin

---

**üéØ TU ES PR√äT √Ä D√âMARRER LA PHASE 2 !**

Lis d'abord :
1. `docs/GUARDIAN_AUDIT_RECOMMENDATIONS.md` (sections Priorit√© 4-5)
2. `claude-plugins/integrity-docs-guardian/README_GUARDIAN.md`
3. Ce prompt

Puis commence par Phase 2.1 (Documentation).

Bonne chance ! üöÄ
