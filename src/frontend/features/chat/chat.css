/* src/frontend/features/chat/chat.css */
/* V11.2 — Ajout styles RAG "Power" rouge/vert (IEC 60417-5007) + scope strict chat. */

:root{
  --glass-bg: rgba(22,22,26,.55);
  --glass-blur: 18px;
  --glass-border-color: rgba(255,255,255,.10);
  --glass-shadow: 0 10px 30px rgba(0,0,0,.35);
  --radius-xl: 18px;

  --color-text-primary:#e9e9ef;

  --chat-bubble-width: 900px;
  --bubbleW: min(var(--chat-bubble-width), 90%);

  --color-anima:#e11d48; /* Rouge "OFF" */
  --color-neo:#2563eb;
  --color-nexus:#10b981; /* Vert "ON"  */
  --user-hex: #6a0dad;
  --bubble-tint: 80%;

  --rag-off: var(--color-anima);
  --rag-on:  var(--color-nexus);
}

.chat-container{
  background:var(--glass-bg);
  -webkit-backdrop-filter:blur(var(--glass-blur)); backdrop-filter:blur(var(--glass-blur));
  border:1px solid var(--glass-border-color);
  border-radius:var(--radius-xl);
  box-shadow: var(--glass-shadow);
  display:flex; flex-direction:column; height:100%;
}

.chat-header{
  display:flex; align-items:center; justify-content:space-between; gap:.75rem;
  padding:.875rem 1.25rem;
  border-bottom:1px solid var(--glass-border-color);
  background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
}

/* Messages (50% centrés sur desktop, 100% en mobile) */
.chat-messages{
  display:flex; flex-direction:column; gap:14px;
  padding:1rem 1.25rem;
  max-height:calc(100vh - 260px);
  overflow-y:auto;
  max-width:50%;
  width:100%;
  margin:0 auto;
}

.message{ display:flex; flex-direction:column; gap:.25rem; }
.message.user{ align-items:flex-start; }
.message.assistant{ align-items:flex-start; }

.message-meta{ display:flex; gap:.5rem; font-size:.75rem; font-weight:600; color:#fff; opacity:.9; line-height:1; margin-bottom:.45rem; }
.sender-name { font-family: 'Comic Sans MS', cursive, sans-serif; }
.message-time { font-size: 0.7rem; opacity: 0.75; }

/* Largeur des bulles */
.chat-container .message-content{
  width:100%;
  max-width: var(--bubbleW);
  background:transparent!important; border:none!important; box-shadow:none!important;
  display:flex; flex-direction:column; gap:.5rem;
}

.chat-container .message-text{
  line-height:1.6; color:var(--color-text-primary);
  padding:.85rem 1rem; border-radius:14px; border:none; text-align:left;
  width:100% !important;
  -webkit-backdrop-filter:blur(6px) saturate(120%); backdrop-filter:blur(6px) saturate(120%);
  box-shadow:0 8px 24px rgba(0,0,0,.25), 0 0 22px rgba(255,255,255,.07);
}

/* Couleurs par rôle/agent */
.chat-container .message.assistant.anima .message-text{
  background: color-mix(in srgb, #ff496a var(--bubble-tint), transparent);
  color:#fff;
}
.chat-container .message.assistant.neo .message-text{
  background: color-mix(in srgb, #30a4ff var(--bubble-tint), transparent);
  color:#fff;
}
.chat-container .message.assistant.nexus .message-text{
  background: color-mix(in srgb, #8b5cff var(--bubble-tint), transparent);
  color:#fff;
}
.chat-container .message.user .message-text{
  background: color-mix(in srgb, var(--user-hex) var(--bubble-tint), transparent);
  color:#fff;
}

/* Input */
.chat-input-area{
  padding:.9rem 1.25rem 1.25rem;
  border-top:1px solid var(--glass-border-color);
  background:linear-gradient(0deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
}
.chat-form{ display:grid; grid-template-columns:1fr auto; gap:.5rem; align-items:center; }
.chat-input{
  width:100%; max-height:160px; resize:none;
  background:rgba(255,255,255,.06);
  border:1px solid var(--glass-border-color);
  border-radius:12px; padding:.75rem .9rem; color:#fff; line-height:1.5;
  transition:border-color .2s ease, background .2s ease;
}
.chat-input:focus{ border-color:var(--user-hex); background:rgba(255,255,255,.08); outline:none; }
.chat-send-button{ width:36px; height:36px; display:inline-flex; align-items:center; justify-content:center; }

/* Actions */
.chat-actions{ display:flex; gap:.75rem; flex-wrap:wrap; align-items:center; }

/* =============================== */
/* RAG Power (SVG rouge/vert)      */
/* =============================== */
.chat-container .rag-label{ color:#fff; opacity:.9; font-size:.95rem; display:inline-flex; align-items:center; height:27px; }
.chat-container .rag-power{
  display:inline-flex; align-items:center; justify-content:center;
  width:27px; height:27px; border-radius:50%;
  background: rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.25);
  cursor:pointer;
  transition: transform .15s ease, box-shadow .2s ease, background .2s ease;
}
.chat-container .rag-power:hover{ transform: translateY(-1px); background: rgba(255,255,255,.12); }
.chat-container .rag-power .icon-power{ width:18px; height:18px; }
.chat-container .rag-power .power-line,
.chat-container .rag-power .power-circle{
  fill:none; stroke: var(--rag-off); stroke-width:2.25; stroke-linecap:round; stroke-linejoin:round;
  transition: stroke .2s ease, filter .2s ease;
}
.chat-container .rag-power[aria-checked="true"] .power-line,
.chat-container .rag-power[aria-checked="true"] .power-circle{
  stroke: var(--rag-on);
  filter: drop-shadow(0 0 6px rgba(16,185,129,.65));
}

/* Force "hover" metallic style as base for the chat send button (always visible) */
.chat-send-button{
  filter: brightness(1.05);
  background:
    radial-gradient(130% 130% at 25% 15%, rgba(255,255,255,1) 0%, rgba(255,255,255,.4) 35%, rgba(255,255,255,0) 60%),
    linear-gradient(145deg, #c8c8c8, #f3f3f3);
  box-shadow:
    inset 0 0 10px rgba(255,255,255,0.65),
    inset 0 -12px 20px rgba(0,0,0,0.2),
    0 8px 22px rgba(0,0,0,.32);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: var(--radius-md);
}

/* Responsive : chat centré à 100% sur mobile */
@media (max-width: 768px){
  .chat-messages{ max-width:100%; }
}

@media (max-width: 430px){
  .chat-send-button{ width:44px; height:44px; border:1px solid rgba(255,255,255,.4); border-radius:10px; }
  .chat-actions .button{ padding:.6rem .8rem; }
}
