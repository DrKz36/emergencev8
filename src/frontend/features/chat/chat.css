/* src/frontend/features/chat/chat.css */
/* V11.9 — Overflow-safe (word-wrap/hyphenation) + responsive conservé */

:root{
  --glass-bg: rgba(22,22,26,.55);
  --glass-blur: 18px;
  --glass-border-color: rgba(255,255,255,.10);
  --glass-shadow: 0 10px 30px rgba(0,0,0,.35);
  --radius-xl: 18px;

  --color-text-primary:#e9e9ef;

  --chat-bubble-width: 900px;
  --bubbleW: min(var(--chat-bubble-width), 90%);

  --color-anima:#e11d48;
  --color-neo:#2563eb;
  --color-nexus:#10b981;
  --user-hex: #6a0dad;

  --rag-off: var(--color-anima);
  --rag-on:  var(--color-nexus);
}

/* Card */
.chat-container{
  background:var(--glass-bg);
  -webkit-backdrop-filter:blur(var(--glass-blur)); backdrop-filter:blur(var(--glass-blur));
  border:1px solid var(--glass-border-color);
  border-radius:var(--radius-xl);
  box-shadow: var(--glass-shadow);
  display:flex; flex-direction:column; height:100%;
}
.chat-container.card,
.chat-container .card-header,
.chat-container .card-footer{ background: transparent !important; }

/* Header */
.chat-header{
  display:flex; align-items:center; justify-content:space-between; gap:1rem;
  padding:.875rem 1.25rem;
  border-bottom:1px solid var(--glass-border-color);
}
.header-left{ display:flex; align-items:center; gap:.75rem; }
.agent-selector--header .segmented{ display:flex; gap:.25rem; }

/* Bandeau RAG (masqué) */
.rag-banner{ display:none !important; }

/* Messages */
.chat-messages{
  display:flex; flex-direction:column; gap:14px;
  padding:1rem 1.25rem;
  max-height:calc(100vh - 260px);
  overflow-y:auto;
  max-width:50%;
  width:100%;
  margin:0 auto;
}
.message{ display:flex; flex-direction:column; gap:.25rem; }
.message-meta{ display:flex; gap:.5rem; font-size:.75rem; font-weight:600; color:#fff; opacity:.9; margin-bottom:.45rem; }

/* Bulles */
.chat-container .message-content{
  width:100%;
  max-width: var(--bubbleW);
  background:transparent!important; border:none!important; box-shadow:none!important;
  display:flex; flex-direction:column; gap:.5rem;
}
.chat-container .message-text{
  line-height:1.6; color:var(--color-text-primary);
  padding:.85rem 1rem; border-radius:14px; border:none; text-align:left;
  width:100% !important;

  /* ✅ anti-overflow mobile/desktop */
  overflow-wrap:anywhere;
  word-break:break-word;
  hyphens:auto;

  -webkit-backdrop-filter:blur(6px) saturate(120%); backdrop-filter:blur(6px) saturate(120%);
  background: color-mix(in srgb, #8b5cff 80%, transparent);
}
.chat-container .message.assistant.anima .message-text{ background: color-mix(in srgb, #ff496a 80%, transparent); color:#fff; }
.chat-container .message.assistant.neo   .message-text{ background: color-mix(in srgb, #30a4ff 80%, transparent); color:#fff; }
.chat-container .message.assistant.nexus .message-text{ background: color-mix(in srgb, #8b5cff 80%, transparent); color:#fff; }
.chat-container .message.user .message-text{ background: color-mix(in srgb, var(--user-hex) 80%, transparent); color:#fff; }

/* Composer */
.chat-input-area{
  padding:.9rem 1.25rem 1.25rem;
  border-top:1px solid var(--glass-border-color);
  background: transparent !important;
}
.chat-form{ display:grid; grid-template-columns:1fr auto; gap:.5rem; align-items:center; }

/* Input dark lisible */
.chat-container .chat-input{
  width:100%; max-height:160px; resize:none;
  background: #11151d !important;
  color:#fff !important;
  border:1px solid var(--glass-border-color) !important;
  border-radius:12px; padding:.75rem .9rem; line-height:1.5;
  transition:border-color .2s ease, background .2s ease;
}
.chat-container .chat-input::placeholder{ color:rgba(255,255,255,.6); }
.chat-container .chat-input:focus{ border-color: var(--user-hex) !important; outline:none; }

/* Bouton envoyer */
.chat-container .chat-send-button{
  all: unset;
  display:inline-flex; align-items:center; justify-content:center;
  width:36px; height:36px;
  background:#0e1117; color:#fff;
  border:1px solid rgba(255,255,255,.15);
  border-radius:10px;
  cursor:pointer;
  transition:transform .15s ease, box-shadow .2s ease, background .2s ease;
}
.chat-container .chat-send-button:hover{
  transform: translateY(-1px);
  box-shadow: 0 0 12px rgba(99,102,241,.35);
}

/* RAG switch sombre (rouge OFF / vert ON) */
.chat-actions{ display:flex; gap:.75rem; flex-wrap:wrap; align-items:center; width:100%; }
.chat-container .rag-label{ color:#fff; opacity:.9; font-size:.95rem; display:inline-flex; align-items:center; height:27px; }
.chat-container .rag-power{
  display:inline-flex; align-items:center; justify-content:center;
  width:27px; height:27px; border-radius:8px;
  background:#0e1117; border:1px solid rgba(255,255,255,.15);
  cursor:pointer;
  transition: transform .15s ease, background .2s ease, box-shadow .2s ease;
}
.chat-container .rag-power:hover{ transform: translateY(-1px); }
.chat-container .rag-power .icon-power{ width:18px; height:18px; }
.chat-container .rag-power .power-line,
.chat-container .rag-power .power-circle{
  fill:none; stroke: var(--rag-off); stroke-width:2.25; stroke-linecap:round; stroke-linejoin:round;
}
.chat-container .rag-power[aria-checked="true"] .power-line,
.chat-container .rag-power[aria-checked="true"] .power-circle{
  stroke: var(--rag-on);
}

/* Tabs header */
.button-tab{ background:transparent; border:none; border-bottom:2px solid transparent; color:#bfc3d9; }
.button-tab.active{ color:#7aa2ff; border-bottom-color:#2563eb; box-shadow:0 0 8px rgba(37,99,235,.55); }

/* Responsive */
@media (max-width: 768px){ .chat-messages{ max-width:100%; } }
@media (max-width: 430px){
  .chat-container .chat-send-button{ width:44px; height:44px; }
}

/* ───────────────────── Mémoire : bandeau sticky ───────────────────── */
.memory-banner{
  position: sticky; top: 0; z-index: 5;
  display: none; align-items: center; gap: .75rem;
  padding: .5rem .75rem; margin: .75rem 1.25rem 0;
  border-radius: 12px;
  background: var(--glass-bg);
  border: 1px solid var(--glass-border-color);
  box-shadow: var(--glass-shadow);
  backdrop-filter: blur(8px);
}
.memory-banner .memory-dot{
  width: .6rem; height: .6rem; border-radius: 50%;
  background: #888;
}
.memory-banner.memory--searching .memory-dot{ background: #f5c542; }
.memory-banner.memory--found     .memory-dot{ background: #2ecc71; }
.memory-banner.memory--empty     .memory-dot{ background: #9aa0a6; }
.memory-banner.memory--error     .memory-dot{ background: #e74c3c; }

.memory-banner .memory-text{ color:#e6e6e6; font-size:.9rem; display:flex; gap:.25rem; align-items:center; }
.memory-banner .memory-sources{ margin-left:auto; max-width:55%; }
.memory-banner .memory-list{
  display:flex; gap:.5rem; list-style:none; margin:0; padding:0; flex-wrap:wrap;
}
.memory-banner .memory-list li{
  max-width: 260px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  font-size:.78rem; color:#cfd3d7; opacity:.9;
}
