<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ÉMERGENCE V8</title>

  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <meta name="google-signin-client_id" content="486095406755-mbjgt9np24o4jg15jrgko74dennlqhp7.apps.googleusercontent.com" />

  <!-- Icônes -->
  <link rel="icon" type="image/png" href="/assets/emergence_logo.png" />
  <link rel="apple-touch-icon" href="/assets/emergence_logo.png" />

  <style>
    :root { --bg:#0b0f1a; --bg-2:#111827; --text:#e5e7eb; --muted:#9ca3af; --border:#1f2937; --sidebar-w:260px; }
    html, body { height: 100%; }
    body { margin: 0; background: var(--bg); color: var(--text);
      font-family: var(--font-sans, -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif); }
    body.loading { overflow: hidden; }
    #app-loader { position: fixed; inset: 0; display:flex; align-items:center; justify-content:center; background-color: var(--bg-2);
      color: var(--muted); z-index: 9999; opacity: 1; transition: opacity .35s ease-out; }
    #app-loader.fade-out { opacity: 0; }
    .app-container { height: 100vh; width: 100vw; }
    @supports (height: 100dvh) { .app-container { height: 100dvh; } }
    .app-content{ overflow-y:auto; overflow-x:hidden; }
  </style>
</head>
<body class="loading">
  <div id="app-loader">
    <img src="/assets/emergence_logo.png" alt="ÉMERGENCE" style="max-height:64px;height:auto;width:auto;opacity:.9;margin-right:12px;object-fit:contain;">
    ÉMERGENCE…
  </div>

  <div id="app-container" class="app-container">
    <aside id="app-sidebar" class="app-sidebar" role="complementary">
      <div class="brand-block">
        <img src="/assets/emergence_logo.png" alt="ÉMERGENCE" class="brand-logo">
        <h1 class="brand-title">ÉMERGENCE</h1>
      </div>
      <nav id="app-tabs" class="sidebar-nav" aria-label="Sections"></nav>
      <div id="settings-container"></div>
    </aside>

    <main id="app-content" class="app-content" role="main">
      <div class="skeleton" style="height: calc(100vh - 56px); border: 1px solid var(--border); border-radius: 10px;"></div>
      <div class="skeleton" style="margin-top:10px; height: 44px; border-radius: 10px;"></div>
    </main>
  </div>

  <script>
    (function () {
      performance.mark('html:begin');
      var nav = performance.getEntriesByType && performance.getEntriesByType('navigation')[0];
      window.__EMERGENCE_BOOT__ = { ttfb_ms: nav ? Math.round(nav.responseStart) : undefined };
      document.addEventListener('DOMContentLoaded', function () {
        requestAnimationFrame(function () {
          var loader = document.getElementById('app-loader');
          if (loader) { loader.classList.add('fade-out'); setTimeout(function(){ loader.remove(); }, 250); }
          document.body.classList.remove('loading');
          console.log('[BOOT][front]', window.__EMERGENCE_BOOT__);
        });
      });
    })();
  </script>

  <!-- Entrée Vite : en dev, /src/frontend/main.js ; en prod, Vite réécrit vers /assets/*.js -->
  <script type="module" src="/src/frontend/main.js"></script>
</body>
</html>
